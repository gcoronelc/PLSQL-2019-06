
CREATE OR REPLACE TRIGGER SCOTT.TR_LOG_EMP_SAL 
AFTER INSERT OR UPDATE ON SCOTT.EMP 
FOR EACH ROW 
BEGIN 

  -- Reto: Este insert solo se debe ejecutar cuando
  --       cambie el salario
  IF UPDATING THEN
    IF :old.SAL <> :new.sal THEN  
      INSERT INTO SCOTT.SAL_HISTORY(EMPNO, SALOLD, SALNEW, STARTDATE, SETUSER) 
      VALUES( :NEW.EMPNO, :OLD.SAL, :NEW.SAL, SYSDATE, USER ); 
    END IF;
  END IF;
  
END TR_LOG_EMP_SAL;
/

SELECT * FROM SCOTT.SAL_HISTORY;

INSERT INTO SCOTT.EMP( EMPNO, ENAME, SAL )
VALUES( 9998, ' GUSTAVO2', 8888 );

UPDATE SCOTT.EMP SET ENAME='CORONEL' WHERE EMPNO = 9999;

UPDATE SCOTT.EMP SET SAL=9999 WHERE EMPNO = 9999;
